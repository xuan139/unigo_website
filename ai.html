<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Chat Demo</title>
  <script type="module">
    import { pipeline } from "https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0";

    let generator;

    async function init() {
      document.getElementById("status").innerText = "â³ æ­£åœ¨åŠ è½½æ¨¡å‹ï¼Œè¯·ç¨ç­‰...";
      // åŠ è½½ä¸€ä¸ªå°å‹ GPT æ¨¡å‹ï¼ˆtiny ç‰ˆæœ¬ï¼Œé€‚åˆæµè§ˆå™¨ï¼‰
      generator = await pipeline(
        "text-generation",
        "Xenova/distilgpt2"  // ä¹Ÿå¯æ¢æ›´å°çš„ gpt2 æ¨¡å‹
      );
      document.getElementById("status").innerText = "âœ… æ¨¡å‹å·²å°±ç»ªï¼Œå¯ä»¥èŠå¤©å•¦ï¼";
    }

    async function chat() {
      const input = document.getElementById("userInput").value;
      if (!input.trim()) return;

      const outputBox = document.getElementById("chatBox");
      outputBox.innerHTML += `<p><b>ä½ :</b> ${input}</p>`;

      const response = await generator(input, {
        max_new_tokens: 50,
        temperature: 0.7,
        top_p: 0.9
      });

      const aiText = response[0].generated_text.replace(input, "").trim();
      outputBox.innerHTML += `<p><b>AI:</b> ${aiText}</p>`;
      document.getElementById("userInput").value = "";
    }

    init();
    window.chat = chat;
  </script>
</head>
<body style="font-family: sans-serif; max-width: 700px; margin: 2rem auto;">
  <h2>ğŸ¤– æœ¬åœ°èŠå¤© AI Demo</h2>
  <p id="status">åŠ è½½ä¸­...</p>

  <div id="chatBox" style="border: 1px solid #ccc; padding: 10px; min-height: 200px;"></div>

  <textarea id="userInput" rows="3" cols="60" placeholder="è¾“å…¥ä¸€å¥è¯..."></textarea><br><br>
  <button onclick="chat()">å‘é€</button>
</body>
</html>
